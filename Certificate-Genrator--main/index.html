<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <link rel="favicon" href="favicon.ico" />
    <!-- Primary Meta Tags -->
    <title>Get your certificate of IWD NAGPUR 2023</title>
    <meta
      name="title"
      content="Get your certificate of IWD NAGPUR 20231"
    />
   
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>
  </head>

  <body>
    <header>
      <img src="logo-wtm.svg" alt="Sentricuss Logo" />

      <h4>
        Get your certificate of <br />
        Parbhani Talent Hunt 2021
      </h4>
      <h3>
        <a
          href="http://www.sentricuss.com/"
          target="_blank"
          rel="noopener noreferrer"
          >IWD NAGPUR 2023 - WTM NAGPUR</a
        >
      </h3>
    </header>
    <main>
      <label for="name">Your Registerd Email</label>

      <input
        required
        type="email"
        name="email"
        autocomplete="name"
        placeholder="Enter Your Email"
        id="email"
      />
      <button onclick="search()">Click Here to Download Certificate</button>
    </main>
    <script>


      function search() {
        const email = document.getElementById("email").value;
        const csvFile = "data.csv";

        Papa.parse(csvFile, {
          download: true,
          header: true,
          complete: function (results) {
            const rows = results.data;
            let found = false;
            for (let i = 0; i < rows.length; i++) {
              const row = rows[i];
              if (row.email === email) {
                validateData(row.name);
                found = true;
                break;
              }
            }
            if (!found) {
              handleNotFound();
            }
          },
        });
      }

      function handleNotFound() {
        alert("Email not found!");
      }

      function validateData(name) {
        // const capitalize = (str, lower = false) =>
        //   (lower ? str.toLowerCase() : str).replace(
        //     /(?:^|\s|["'([{])+\S/g,
        //     (match) => match.toUpperCase()
        //   );
        // const val = capitalize(name);

        //check if the text is empty or not
        if (name.trim() !== "") {
          generatePDF(name);
        } else {
          console.log("somthing went wrong");
        }
      }
    </script>
    <script src="https://unpkg.com/pdf-lib@1.4.0"></script>
    <script src="./FileSaver.js"></script>
    <script src="https://unpkg.com/@pdf-lib/fontkit@0.0.4"></script>
    <script src="./index.js"></script>
  </body>
</html>
